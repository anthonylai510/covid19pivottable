<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width,initial-scale=1">

  <title>WebPivotTable Component</title>

  <style type="text/css">
    html, body, #wpt-container {width:100%;height:100%; padding:0; margin:0;}
  </style>

  <script type="text/javascript" src="./dist/wpt.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <script>
     $(document).ready(function(){
       var wpt = $('web-pivot-table')[0];
       wpt.setOptions({
         styles: {
           highLightColor: 'rgb(250, 224, 177)',
         },
         uiFlags: {
           report: 0,
         },
         customHandlers: {
           connectSource: 0,
           openWpt: 1,
           saveWpt: 1,
           drillThrough: 1
         },
         filestack: {
           enabled: true,
           key: "A4bieoUsyR4yBrNPkFIvrz"  //demo.webpivottable.com
         },
         fileLinks: [
           {
             type: wpt.Constants.sourceType.WPT,
             url: "https://anthonylai510.github.io/covid19pivottable/data/US-COVID19-Trend.wpt",
             label: "US COVID-19 Trend"
           },{
             type: wpt.Constants.sourceType.EXCEL,
             url: "https://anthonylai510.github.io/covid19pivottable/data/covid19-data.xlsx",
             label: "World COVID-19 Data (EXCEL)"
           }
         ],
         server: {
           fileProxyEnabled: 0,          // enable/disable file Proxy 1/0
           fileProxy: 'http://localhost:8003/wpt/fileProxy',  // Server proxy for cross domain file acess
           fileTimeout: 30000,
           xmlaProxyEnabled: 1,        // enable/disable Xmla Proxy 1/0
           xmlaProxy: 'http://demo.webpivottable.com/wpt/xmlaProxy', // Server proxy for cross domain xmla access
           xmlaTimeout: 30000,
         },

       });

       wpt.addEventListener(wpt.Constants.eventType.NEW_WPT, function(event) {
         console.log("customize newWpt", event);
       });

       wpt.addEventListener(wpt.Constants.eventType.OPEN_WPT, function(event) {
         console.log("customize open Wpt", event);
       });

       wpt.addEventListener(wpt.Constants.eventType.SAVE_WPT, function(event) {
         console.log("customize saveWpt", event);
       });

       wpt.addEventListener(wpt.Constants.eventType.DRILL_THROUGH, function(event) {
         console.log("customize drillthrough", event);
       });

        wpt.setWptFromWptUrl("https://anthonylai510.github.io/covid19pivottable/data/US-COVID19-Trend.wpt");

       $('#locale-select').on('change', function() {
         var value = this.value;
         if (value) {
           var wpt = $('web-pivot-table')[0];
           wpt.setLocale(value);
         }
       });
     });
  </script>

</head>

<body>
  <div style="padding:10px;">
    <h3 style="text-align: center;margin:0;">US COVID-19 Confirmed Cases Trend</h3>
  </div>

  <div id="wpt-container">
    <web-pivot-table />
  </div>
</body>

</html>